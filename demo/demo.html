<!DOCTYPE hmtl>
<html>
    <head>
        <script src="script.js"></script>
    </head>
    <body>
        <button data-state="off" disabled="true" id="start">Start</button>
        <span id="pitch">__</span> Hz
    </body>
    <script>
        const buttonEl = document.querySelector('#start');
        const pitchEl = document.querySelector('#pitch');
        const setPitch = pitch => pitchEl.innerText = pitch >= 0 ? pitch : '__';

        moduleLoadingPromise
          .then(() => {
              buttonEl.disabled = false;
              // TODO ML Add function to keep track of how long it is taking for pitch to be detected
              Module.addPitchListener(setPitch);
          });

        buttonEl.onclick = () => {           
            if (buttonEl.dataset.state === 'off') {
              buttonEl.innerText = 'Stop';
              buttonEl.dataset.state = 'on';
              Module.start();
            } else {
              buttonEl.innerText = 'Start';
              buttonEl.dataset.state = 'off';
              Module.stop();
            }
        };
        // CONTINUE ML How to know if Module object has been asychronously created?
    </script>
    <script src="wasm_interface.js"></script>
</html>